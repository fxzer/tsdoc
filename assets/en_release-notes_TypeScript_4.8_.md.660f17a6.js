import{_ as s,o as n,c as a,V as e}from"./chunks/framework.ced88878.js";const h=JSON.parse('{"title":"TypeScript 4.8","description":"","frontmatter":{"title":"TypeScript 4.8","layout":"docs","permalink":"/docs/handbook/release-notes/typescript-4-8.html","oneline":"TypeScript 4.8 Release Notes"},"headers":[],"relativePath":"en/release-notes/TypeScript[4.8].md","lastUpdated":1681915487000}'),o={name:"en/release-notes/TypeScript[4.8].md"},l=e(`<h2 id="improved-intersection-reduction-union-compatibility-and-narrowing" tabindex="-1">Improved Intersection Reduction, Union Compatibility, and Narrowing <a class="header-anchor" href="#improved-intersection-reduction-union-compatibility-and-narrowing" aria-label="Permalink to &quot;Improved Intersection Reduction, Union Compatibility, and Narrowing&quot;">​</a></h2><p>TypeScript 4.8 brings a series of correctness and consistency improvements under <code>--strictNullChecks</code>. These changes affect how intersection and union types work, and are leveraged in how TypeScript narrows types.</p><p>For example, <code>unknown</code> is close in spirit to the union type <code>{} | null | undefined</code> because it accepts <code>null</code>, <code>undefined</code>, and any other type. TypeScript now recognizes this, and allows assignments from <code>unknown</code> to <code>{} | null | undefined</code>.</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">function</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">f</span><span style="color:#F6F6F4;">(</span><span style="color:#FFB86C;font-style:italic;">x</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">unknown</span><span style="color:#F6F6F4;">, </span><span style="color:#FFB86C;font-style:italic;">y</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {} </span><span style="color:#F286C4;">|</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">null</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">|</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">undefined</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    x </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> y; </span><span style="color:#7B7F8B;">// always worked</span></span>
<span class="line"><span style="color:#F6F6F4;">    y </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> x; </span><span style="color:#7B7F8B;">// used to error, now works</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">f</span><span style="color:#24292E;">(</span><span style="color:#E36209;">x</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">unknown</span><span style="color:#24292E;">, </span><span style="color:#E36209;">y</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> {} </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">null</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">undefined</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    x </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> y; </span><span style="color:#6A737D;">// always worked</span></span>
<span class="line"><span style="color:#24292E;">    y </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> x; </span><span style="color:#6A737D;">// used to error, now works</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>Another change is that <code>{}</code> intersected with any other object type simplifies right down to that object type. That meant that we were able to rewrite <code>NonNullable</code> to just use an intersection with <code>{}</code>, because <code>{} &amp; null</code> and <code>{} &amp; undefined</code> just get tossed away.</p><div class="language-diff"><button title="Copy Code" class="copy"></button><span class="lang">diff</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#EE6666;">- type NonNullable&lt;T&gt; = T extends null | undefined ? never : T;</span></span>
<span class="line"><span style="color:#62E884;">+ type NonNullable&lt;T&gt; = T &amp; {};</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#B31D28;">- type NonNullable&lt;T&gt; = T extends null | undefined ? never : T;</span></span>
<span class="line"><span style="color:#22863A;">+ type NonNullable&lt;T&gt; = T &amp; {};</span></span></code></pre></div><p>This is an improvement because intersection types like this can be reduced and assigned to, while conditional types currently cannot. So <code>NonNullable&lt;NonNullable&lt;T&gt;&gt;</code> now simplifies at least to <code>NonNullable&lt;T&gt;</code>, whereas it didn&#39;t before.</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">function</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">foo</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#FFB86C;font-style:italic;">T</span><span style="color:#F6F6F4;">&gt;(</span><span style="color:#FFB86C;font-style:italic;">x</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">NonNullable</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#FFB86C;font-style:italic;">T</span><span style="color:#F6F6F4;">&gt;, </span><span style="color:#FFB86C;font-style:italic;">y</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">NonNullable</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#FFB86C;font-style:italic;">NonNullable</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#FFB86C;font-style:italic;">T</span><span style="color:#F6F6F4;">&gt;&gt;) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    x </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> y; </span><span style="color:#7B7F8B;">// always worked</span></span>
<span class="line"><span style="color:#F6F6F4;">    y </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> x; </span><span style="color:#7B7F8B;">// used to error, now works</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">foo</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">&gt;(</span><span style="color:#E36209;">x</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NonNullable</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">&gt;, </span><span style="color:#E36209;">y</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NonNullable</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">NonNullable</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">&gt;&gt;) {</span></span>
<span class="line"><span style="color:#24292E;">    x </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> y; </span><span style="color:#6A737D;">// always worked</span></span>
<span class="line"><span style="color:#24292E;">    y </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> x; </span><span style="color:#6A737D;">// used to error, now works</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>These changes also allowed us to bring in sensible improvements in control flow analysis and type narrowing. For example, <code>unknown</code> is now narrowed just like <code>{} | null | undefined</code> in truthy branches.</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">function</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">narrowUnknownishUnion</span><span style="color:#F6F6F4;">(</span><span style="color:#FFB86C;font-style:italic;">x</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {} </span><span style="color:#F286C4;">|</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">null</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">|</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">undefined</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (x) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        x;  </span><span style="color:#7B7F8B;">// {}</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">else</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">        x;  </span><span style="color:#7B7F8B;">// {} | null | undefined</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F286C4;">function</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">narrowUnknown</span><span style="color:#F6F6F4;">(</span><span style="color:#FFB86C;font-style:italic;">x</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">unknown</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (x) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        x;  </span><span style="color:#7B7F8B;">// used to be &#39;unknown&#39;, now &#39;{}&#39;</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">else</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">        x;  </span><span style="color:#7B7F8B;">// unknown</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">narrowUnknownishUnion</span><span style="color:#24292E;">(</span><span style="color:#E36209;">x</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> {} </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">null</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">undefined</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (x) {</span></span>
<span class="line"><span style="color:#24292E;">        x;  </span><span style="color:#6A737D;">// {}</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        x;  </span><span style="color:#6A737D;">// {} | null | undefined</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">narrowUnknown</span><span style="color:#24292E;">(</span><span style="color:#E36209;">x</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">unknown</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (x) {</span></span>
<span class="line"><span style="color:#24292E;">        x;  </span><span style="color:#6A737D;">// used to be &#39;unknown&#39;, now &#39;{}&#39;</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        x;  </span><span style="color:#6A737D;">// unknown</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>Generic values also get narrowed similarly. When checking that a value isn&#39;t <code>null</code> or <code>undefined</code>, TypeScript now just intersects it with <code>{}</code> - which again, is the same as saying it&#39;s <code>NonNullable</code>. Putting many of the changes here together, we can now define the following function without any type assertions.</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">function</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">throwIfNullable</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#FFB86C;font-style:italic;">T</span><span style="color:#F6F6F4;">&gt;(</span><span style="color:#FFB86C;font-style:italic;">value</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">T</span><span style="color:#F6F6F4;">)</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">NonNullable</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#FFB86C;font-style:italic;">T</span><span style="color:#F6F6F4;">&gt; {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (value </span><span style="color:#F286C4;">===</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">undefined</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">||</span><span style="color:#F6F6F4;"> value </span><span style="color:#F286C4;">===</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">null</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">        </span><span style="color:#F286C4;">throw</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">Error</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">Nullable value!</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">);</span></span>
<span class="line"><span style="color:#F6F6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">// Used to fail because &#39;T&#39; was not assignable to &#39;NonNullable&lt;T&gt;&#39;.</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">// Now narrows to &#39;T &amp; {}&#39; and succeeds because that&#39;s just &#39;NonNullable&lt;T&gt;&#39;.</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#F286C4;">return</span><span style="color:#F6F6F4;"> value;</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">throwIfNullable</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">&gt;(</span><span style="color:#E36209;">value</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">NonNullable</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">&gt; {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (value </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">undefined</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">||</span><span style="color:#24292E;"> value </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">null</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">throw</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Error</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Nullable value!&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// Used to fail because &#39;T&#39; was not assignable to &#39;NonNullable&lt;T&gt;&#39;.</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// Now narrows to &#39;T &amp; {}&#39; and succeeds because that&#39;s just &#39;NonNullable&lt;T&gt;&#39;.</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> value;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p><code>value</code> now gets narrowed to <code>T &amp; {}</code>, and is now identical with <code>NonNullable&lt;T&gt;</code> - so the body of the function just works with no TypeScript-specific syntax.</p><p>On their own, these changes may appear small - but they represent fixes for many many paper cuts that have been reported over several years.</p><p>For more specifics on these improvements, you can <a href="https://github.com/microsoft/TypeScript/pull/49119" target="_blank" rel="noreferrer">read more here</a>.</p><h2 id="improved-inference-for-infer-types-in-template-string-types" tabindex="-1">Improved Inference for <code>infer</code> Types in Template String Types <a class="header-anchor" href="#improved-inference-for-infer-types-in-template-string-types" aria-label="Permalink to &quot;Improved Inference for \`infer\` Types in Template String Types&quot;">​</a></h2><p>TypeScript recently introduced a way to add <code>extends</code> constraints to <code>infer</code> type variables in conditional types.</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">// Grabs the first element of a tuple if it&#39;s assignable to &#39;number&#39;,</span></span>
<span class="line"><span style="color:#7B7F8B;">// and returns &#39;never&#39; if it can&#39;t find one.</span></span>
<span class="line"><span style="color:#F286C4;">type</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">TryGetNumberIfFirst</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#FFB86C;font-style:italic;">T</span><span style="color:#F6F6F4;">&gt; </span><span style="color:#F286C4;">=</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;font-style:italic;">T</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">extends</span><span style="color:#F6F6F4;"> [</span><span style="color:#F286C4;">infer</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">U</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">extends</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">number</span><span style="color:#F6F6F4;">, </span><span style="color:#F286C4;">...</span><span style="color:#97E1F1;font-style:italic;">unknown</span><span style="color:#F6F6F4;">[]] </span><span style="color:#F286C4;">?</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">U</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">never</span><span style="color:#F6F6F4;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// Grabs the first element of a tuple if it&#39;s assignable to &#39;number&#39;,</span></span>
<span class="line"><span style="color:#6A737D;">// and returns &#39;never&#39; if it can&#39;t find one.</span></span>
<span class="line"><span style="color:#D73A49;">type</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">TryGetNumberIfFirst</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">&gt; </span><span style="color:#D73A49;">=</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">T</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> [</span><span style="color:#D73A49;">infer</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">U</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">number</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">...</span><span style="color:#005CC5;">unknown</span><span style="color:#24292E;">[]] </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">U</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">never</span><span style="color:#24292E;">;</span></span></code></pre></div><p>If these <code>infer</code> types appear in a template string type and are constrained to a primitive type, TypeScript will now try to parse out a literal type.</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">// SomeNum used to be &#39;number&#39;; now it&#39;s &#39;100&#39;.</span></span>
<span class="line"><span style="color:#F286C4;">type</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">SomeNum</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">100</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">extends</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">\`</span><span style="color:#F286C4;">\${</span><span style="color:#F286C4;">infer</span><span style="color:#E7EE98;"> </span><span style="color:#97E1F1;font-style:italic;">U</span><span style="color:#E7EE98;"> </span><span style="color:#F286C4;">extends</span><span style="color:#E7EE98;"> </span><span style="color:#97E1F1;font-style:italic;">number</span><span style="color:#F286C4;">}</span><span style="color:#E7EE98;">\`</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">?</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">U</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">never</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7B7F8B;">// SomeBigInt used to be &#39;bigint&#39;; now it&#39;s &#39;100n&#39;.</span></span>
<span class="line"><span style="color:#F286C4;">type</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">SomeBigInt</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">100</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">extends</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">\`</span><span style="color:#F286C4;">\${</span><span style="color:#F286C4;">infer</span><span style="color:#E7EE98;"> </span><span style="color:#97E1F1;font-style:italic;">U</span><span style="color:#E7EE98;"> </span><span style="color:#F286C4;">extends</span><span style="color:#E7EE98;"> </span><span style="color:#97E1F1;font-style:italic;">bigint</span><span style="color:#F286C4;">}</span><span style="color:#E7EE98;">\`</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">?</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">U</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">never</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7B7F8B;">// SomeBool used to be &#39;boolean&#39;; now it&#39;s &#39;true&#39;.</span></span>
<span class="line"><span style="color:#F286C4;">type</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">SomeBool</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">true</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">extends</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">\`</span><span style="color:#F286C4;">\${</span><span style="color:#F286C4;">infer</span><span style="color:#E7EE98;"> </span><span style="color:#97E1F1;font-style:italic;">U</span><span style="color:#E7EE98;"> </span><span style="color:#F286C4;">extends</span><span style="color:#E7EE98;"> </span><span style="color:#97E1F1;font-style:italic;">boolean</span><span style="color:#F286C4;">}</span><span style="color:#E7EE98;">\`</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">?</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">U</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">never</span><span style="color:#F6F6F4;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// SomeNum used to be &#39;number&#39;; now it&#39;s &#39;100&#39;.</span></span>
<span class="line"><span style="color:#D73A49;">type</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SomeNum</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;100&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#032F62;">\`\${</span><span style="color:#D73A49;">infer</span><span style="color:#032F62;"> </span><span style="color:#6F42C1;">U</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">extends</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">number</span><span style="color:#032F62;">}\`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">U</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">never</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// SomeBigInt used to be &#39;bigint&#39;; now it&#39;s &#39;100n&#39;.</span></span>
<span class="line"><span style="color:#D73A49;">type</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SomeBigInt</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;100&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#032F62;">\`\${</span><span style="color:#D73A49;">infer</span><span style="color:#032F62;"> </span><span style="color:#6F42C1;">U</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">extends</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">bigint</span><span style="color:#032F62;">}\`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">U</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">never</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// SomeBool used to be &#39;boolean&#39;; now it&#39;s &#39;true&#39;.</span></span>
<span class="line"><span style="color:#D73A49;">type</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SomeBool</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;true&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#032F62;">\`\${</span><span style="color:#D73A49;">infer</span><span style="color:#032F62;"> </span><span style="color:#6F42C1;">U</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">extends</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">boolean</span><span style="color:#032F62;">}\`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">U</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">never</span><span style="color:#24292E;">;</span></span></code></pre></div><p>This can now better convey what a library will do at runtime, and give more precise types.</p><p>One note on this is that when TypeScript parses these literal types out it will greedily try to parse out as much of what looks like of the appropriate primitive type; however it then checks to see if the print-back of that primitive matches up with the string contents. In other words, TypeScript checks whether the going from the string, to the primitive, and back matches. If it doesn&#39;t see that the string can be &quot;round-tripped&quot;, then it will fall back to the base primitive type.</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">// JustNumber is \`number\` here because TypeScript parses out \`&quot;1.0&quot;\`, but \`String(Number(&quot;1.0&quot;))\` is \`&quot;1&quot;\` and doesn&#39;t match.</span></span>
<span class="line"><span style="color:#F286C4;">type</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">JustNumber</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">1.0</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">extends</span><span style="color:#F6F6F4;"> </span><span style="color:#E7EE98;">\`</span><span style="color:#F286C4;">\${</span><span style="color:#F286C4;">infer</span><span style="color:#E7EE98;"> </span><span style="color:#97E1F1;font-style:italic;">T</span><span style="color:#E7EE98;"> </span><span style="color:#F286C4;">extends</span><span style="color:#E7EE98;"> </span><span style="color:#97E1F1;font-style:italic;">number</span><span style="color:#F286C4;">}</span><span style="color:#E7EE98;">\`</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">?</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">T</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">never</span><span style="color:#F6F6F4;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// JustNumber is \`number\` here because TypeScript parses out \`&quot;1.0&quot;\`, but \`String(Number(&quot;1.0&quot;))\` is \`&quot;1&quot;\` and doesn&#39;t match.</span></span>
<span class="line"><span style="color:#D73A49;">type</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">JustNumber</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;1.0&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> </span><span style="color:#032F62;">\`\${</span><span style="color:#D73A49;">infer</span><span style="color:#032F62;"> </span><span style="color:#6F42C1;">T</span><span style="color:#032F62;"> </span><span style="color:#D73A49;">extends</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">number</span><span style="color:#032F62;">}\`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">never</span><span style="color:#24292E;">;</span></span></code></pre></div><p>You can <a href="https://github.com/microsoft/TypeScript/pull/48094" target="_blank" rel="noreferrer">see more about this feature here</a>.</p><h2 id="build-watch-and-incremental-performance-improvements" tabindex="-1"><code>--build</code>, <code>--watch</code>, and <code>--incremental</code> Performance Improvements <a class="header-anchor" href="#build-watch-and-incremental-performance-improvements" aria-label="Permalink to &quot;\`--build\`, \`--watch\`, and \`--incremental\` Performance Improvements&quot;">​</a></h2><p>TypeScript 4.8 introduces several optimizations that should speed up scenarios around <code>--watch</code> and <code>--incremental</code>, along with project references builds using <code>--build</code>. For example, TypeScript is now able to avoid spending time updating timestamps during no-op changes in <code>--watch</code> mode, which makes rebuilds faster and avoids messing with other build tools that might be watching for TypeScript&#39;s output. Many other optimizations where we&#39;re able to reuse information across <code>--build</code>, <code>--watch</code>, and <code>--incremental</code> have been introduced as well.</p><p>How big are these improvements? Well, on a fairly large internal codebase, we&#39;ve seen time reductions on the order of 10%-25% on many simple common operations, with around 40% time reductions in no-change scenarios. We&#39;ve seen similar results on the TypeScript codebase as well.</p><p>You can see <a href="https://github.com/microsoft/TypeScript/pull/48784" target="_blank" rel="noreferrer">the changes, along with the performance results on GitHub</a>.</p><h2 id="errors-when-comparing-object-and-array-literals" tabindex="-1">Errors When Comparing Object and Array Literals <a class="header-anchor" href="#errors-when-comparing-object-and-array-literals" aria-label="Permalink to &quot;Errors When Comparing Object and Array Literals&quot;">​</a></h2><p>In many languages, operators like <code>==</code> perform what&#39;s called &quot;value&quot; equality on objects. For example, in Python it&#39;s valid to check whether a list is empty by checking whether a value is equal to the empty list using <code>==</code>.</p><div class="language-py"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> people_at_home </span><span style="color:#F286C4;">==</span><span style="color:#F6F6F4;"> []:</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E1F1;">print</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">here&#39;s where I lie, broken inside. &lt;/3</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    adopt_animals()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> people_at_home </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> []:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;here&#39;s where I lie, broken inside. &lt;/3&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    adopt_animals()</span></span></code></pre></div><p>This is not the case in JavaScript, where <code>==</code> and <code>===</code> between objects (and therefore, arrays) check whether both references point to the same value. We believe that similar code in JavaScript is at best an early foot-gun for JavaScript developers, and at worst a bug in production code. That&#39;s why TypeScript now disallows code like the following.</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">if</span><span style="color:#F6F6F4;"> (peopleAtHome </span><span style="color:#F286C4;">===</span><span style="color:#F6F6F4;"> []) {</span></span>
<span class="line"><span style="color:#7B7F8B;">//  ~~~~~~~~~~~~~~~~~~~</span></span>
<span class="line"><span style="color:#7B7F8B;">// This condition will always return &#39;false&#39; since JavaScript compares objects by reference, not value.</span></span>
<span class="line"><span style="color:#F6F6F4;">    console.</span><span style="color:#62E884;">log</span><span style="color:#F6F6F4;">(</span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">here&#39;s where I lie, broken inside. &lt;/3</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">)</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#62E884;">adoptAnimals</span><span style="color:#F6F6F4;">();</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (peopleAtHome </span><span style="color:#D73A49;">===</span><span style="color:#24292E;"> []) {</span></span>
<span class="line"><span style="color:#6A737D;">//  ~~~~~~~~~~~~~~~~~~~</span></span>
<span class="line"><span style="color:#6A737D;">// This condition will always return &#39;false&#39; since JavaScript compares objects by reference, not value.</span></span>
<span class="line"><span style="color:#24292E;">    console.</span><span style="color:#6F42C1;">log</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;here&#39;s where I lie, broken inside. &lt;/3&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">adoptAnimals</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>We&#39;d like to extend our gratitude to <a href="https://github.com/Jack-Works" target="_blank" rel="noreferrer">Jack Works</a> who contributed this check. You can <a href="https://github.com/microsoft/TypeScript/pull/45978" target="_blank" rel="noreferrer">view the changes involved here</a>.</p><h2 id="improved-inference-from-binding-patterns" tabindex="-1">Improved Inference from Binding Patterns <a class="header-anchor" href="#improved-inference-from-binding-patterns" aria-label="Permalink to &quot;Improved Inference from Binding Patterns&quot;">​</a></h2><p>In some cases, TypeScript will pick up a type from a binding pattern to make better inferences.</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">declare</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">function</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">chooseRandomly</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#FFB86C;font-style:italic;">T</span><span style="color:#F6F6F4;">&gt;(</span><span style="color:#FFB86C;font-style:italic;">x</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">T</span><span style="color:#F6F6F4;">, </span><span style="color:#FFB86C;font-style:italic;">y</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">T</span><span style="color:#F6F6F4;">)</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">T</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F286C4;">let</span><span style="color:#F6F6F4;"> [a, b, c] </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">chooseRandomly</span><span style="color:#F6F6F4;">([</span><span style="color:#BF9EEE;">42</span><span style="color:#F6F6F4;">, </span><span style="color:#BF9EEE;">true</span><span style="color:#F6F6F4;">, </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">hi!</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">], [</span><span style="color:#BF9EEE;">0</span><span style="color:#F6F6F4;">, </span><span style="color:#BF9EEE;">false</span><span style="color:#F6F6F4;">, </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">bye!</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">]);</span></span>
<span class="line"><span style="color:#7B7F8B;">//   ^  ^  ^</span></span>
<span class="line"><span style="color:#7B7F8B;">//   |  |  |</span></span>
<span class="line"><span style="color:#7B7F8B;">//   |  |  string</span></span>
<span class="line"><span style="color:#7B7F8B;">//   |  |</span></span>
<span class="line"><span style="color:#7B7F8B;">//   |  boolean</span></span>
<span class="line"><span style="color:#7B7F8B;">//   |</span></span>
<span class="line"><span style="color:#7B7F8B;">//   number</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">declare</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">chooseRandomly</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">&gt;(</span><span style="color:#E36209;">x</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">, </span><span style="color:#E36209;">y</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">let</span><span style="color:#24292E;"> [a, b, c] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">chooseRandomly</span><span style="color:#24292E;">([</span><span style="color:#005CC5;">42</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">true</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;hi!&quot;</span><span style="color:#24292E;">], [</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;bye!&quot;</span><span style="color:#24292E;">]);</span></span>
<span class="line"><span style="color:#6A737D;">//   ^  ^  ^</span></span>
<span class="line"><span style="color:#6A737D;">//   |  |  |</span></span>
<span class="line"><span style="color:#6A737D;">//   |  |  string</span></span>
<span class="line"><span style="color:#6A737D;">//   |  |</span></span>
<span class="line"><span style="color:#6A737D;">//   |  boolean</span></span>
<span class="line"><span style="color:#6A737D;">//   |</span></span>
<span class="line"><span style="color:#6A737D;">//   number</span></span></code></pre></div><p>When <code>chooseRandomly</code> needs to figure out a type for <code>T</code>, it will primarily look at <code>[42, true, &quot;hi!&quot;]</code> and <code>[0, false, &quot;bye!&quot;]</code>; but TypeScript needs to figure out whether those two types should be <code>Array&lt;number | boolean | string&gt;</code> or the tuple type <code>[number, boolean, string]</code>. To do that, it will look for existing candidates as a hint to see whether there are any tuple types. When TypeScript sees the binding pattern <code>[a, b, c]</code>, it creates the type <code>[any, any, any]</code>, and that type gets picked up as a low-priority candidate for <code>T</code> which also gets used as a hint for the types of <code>[42, true, &quot;hi!&quot;]</code> and <code>[0, false, &quot;bye!&quot;]</code>.</p><p>You can see how this was good for <code>chooseRandomly</code>, but it fell short in other cases. For example, take the following code</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">declare</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">function</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">f</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#FFB86C;font-style:italic;">T</span><span style="color:#F6F6F4;">&gt;(</span><span style="color:#FFB86C;font-style:italic;">x</span><span style="color:#F286C4;">?:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">T</span><span style="color:#F6F6F4;">)</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">T</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F286C4;">let</span><span style="color:#F6F6F4;"> [x, y, z] </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">f</span><span style="color:#F6F6F4;">();</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">declare</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">f</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">&gt;(</span><span style="color:#E36209;">x</span><span style="color:#D73A49;">?:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">let</span><span style="color:#24292E;"> [x, y, z] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">f</span><span style="color:#24292E;">();</span></span></code></pre></div><p>The binding pattern <code>[x, y, z]</code> hinted that <code>f</code> should produce an <code>[any, any, any]</code> tuple; but <code>f</code> really shouldn&#39;t change its type argument based on a binding pattern. It can&#39;t suddenly conjure up a new array-like value based on what it&#39;s being assigned to, so the binding pattern type has way too much influence on the produced type. On top of that, because the binding pattern type is full of <code>any</code>s, we&#39;re left with <code>x</code>, <code>y</code>, and <code>z</code> being typed as <code>any</code>.</p><p>In TypeScript 4.8, these binding patterns are never used as candidates for type arguments. Instead, they&#39;re just consulted in case a parameter needs a more specific type like in our <code>chooseRandomly</code> example. If you need to revert to the old behavior, you can always provide explicit type arguments.</p><p>You can <a href="https://github.com/microsoft/TypeScript/pull/49086" target="_blank" rel="noreferrer">look at the change on GitHub</a> if you&#39;re curious to learn more.</p><h2 id="file-watching-fixes-especially-across-git-checkouts" tabindex="-1">File-Watching Fixes (Especially Across <code>git checkout</code>s) <a class="header-anchor" href="#file-watching-fixes-especially-across-git-checkouts" aria-label="Permalink to &quot;File-Watching Fixes (Especially Across \`git checkout\`s)&quot;">​</a></h2><p>We&#39;ve had a long-standing bug where TypeScript has a very hard time with certain file changes in <code>--watch</code> mode and editor scenarios. Sometimes the symptoms are stale or inaccurate errors that might show up that require restarting <code>tsc</code> or VS Code. Frequently these occur on Unix systems, and you might have seen these after saving a file with vim or swapping branches in git.</p><p>This was caused by assumptions of how Node.js handles rename events across file systems. File systems used by Linux and macOS utilize <a href="https://en.wikipedia.org/wiki/Inode" target="_blank" rel="noreferrer">inodes</a>, and <a href="https://nodejs.org/api/fs.html#inodes" target="_blank" rel="noreferrer">Node.js will attach file watchers to inodes rather than file paths</a>. So when Node.js returns <a href="https://nodejs.org/api/fs.html#class-fsfswatcher" target="_blank" rel="noreferrer">a watcher object</a>, it might be watching a path or an inode depending on the platform and file system.</p><p>To be a bit more efficient, TypeScript tries to reuse the same watcher objects if it detects a path still exists on disk. This is where things went wrong, because even if a file still exists at that path, a distinct file might have been created, and that file will have a different inode. So TypeScript would end up reusing the watcher object instead of installing a new watcher at the original location, and watch for changes at what might be a totally irrelevant file. So TypeScript 4.8 now handles these cases on inode systems and properly installs a new watcher and fixes this.</p><p>We&#39;d like to extend our thanks to <a href="https://github.com/MarcCelani-at" target="_blank" rel="noreferrer">Marc Celani</a> and his team at Airtable who invested lots of time in investigating the issues they were experiencing and pointing out the root cause. You can view <a href="https://github.com/microsoft/TypeScript/pull/48997" target="_blank" rel="noreferrer">the specific fixes around file-watching here</a>.</p><h2 id="find-all-references-performance-improvements" tabindex="-1">Find-All-References Performance Improvements <a class="header-anchor" href="#find-all-references-performance-improvements" aria-label="Permalink to &quot;Find-All-References Performance Improvements&quot;">​</a></h2><p>When running find-all-references in your editor, TypeScript is now able to act a little smarter as it aggregates references. This reduced the amount of time TypeScript took to search a widely-used identifier in its own codebase by about 20%.</p><p><a href="https://github.com/microsoft/TypeScript/pull/49581" target="_blank" rel="noreferrer">You can read up more on the improvement here</a>.</p><h2 id="exclude-specific-files-from-auto-imports" tabindex="-1">Exclude Specific Files from Auto-Imports <a class="header-anchor" href="#exclude-specific-files-from-auto-imports" aria-label="Permalink to &quot;Exclude Specific Files from Auto-Imports&quot;">​</a></h2><p>TypeScript 4.8 introduces an editor preference for excluding files from auto-imports. In Visual Studio Code, file names or globs can be added under &quot;Auto Import File Exclude Patterns&quot; in the Settings UI, or in a <code>.vscode/settings.json</code> file:</p><div class="language-jsonc"><button title="Copy Code" class="copy"></button><span class="lang">jsonc</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">{</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">// Note that \`javascript.preferences.autoImportFileExcludePatterns\` can be specified for JavaScript too.</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#97E2F2;">&quot;</span><span style="color:#97E1F1;">typescript.preferences.autoImportFileExcludePatterns</span><span style="color:#97E2F2;">&quot;</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> [</span></span>
<span class="line"><span style="color:#F6F6F4;">      </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">**/node_modules/@types/node</span><span style="color:#DEE492;">&quot;</span></span>
<span class="line"><span style="color:#F6F6F4;">    ]</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// Note that \`javascript.preferences.autoImportFileExcludePatterns\` can be specified for JavaScript too.</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">&quot;typescript.preferences.autoImportFileExcludePatterns&quot;</span><span style="color:#24292E;">: [</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#032F62;">&quot;**/node_modules/@types/node&quot;</span></span>
<span class="line"><span style="color:#24292E;">    ]</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>This can be useful in cases where you can&#39;t avoid having certain modules or libraries in your compilation but you rarely want to import from them. These modules might have lots of exports that can pollute the auto-imports list and make it harder to navigate, and this option can help in those situations.</p><p>You can <a href="https://github.com/microsoft/TypeScript/pull/49578" target="_blank" rel="noreferrer">see more specifics about the implementation here</a>.</p><h2 id="correctness-fixes-and-breaking-changes" tabindex="-1">Correctness Fixes and Breaking Changes <a class="header-anchor" href="#correctness-fixes-and-breaking-changes" aria-label="Permalink to &quot;Correctness Fixes and Breaking Changes&quot;">​</a></h2><p>Due to the nature of type system changes, there are very few changes that can be made that don&#39;t affect <em>some</em> code; however, there are a few changes that are more likely to require adapting existing code.</p><h3 id="lib-d-ts-updates" tabindex="-1"><code>lib.d.ts</code> Updates <a class="header-anchor" href="#lib-d-ts-updates" aria-label="Permalink to &quot;\`lib.d.ts\` Updates&quot;">​</a></h3><p>While TypeScript strives to avoid major breaks, even small changes in the built-in libraries can cause issues. We don&#39;t expect major breaks as a result of DOM and <code>lib.d.ts</code> updates, but one notable change is that the <code>cause</code> property on <code>Error</code>s now has the type <code>unknown</code> instead of <code>Error</code>.</p><h3 id="unconstrained-generics-no-longer-assignable-to" tabindex="-1">Unconstrained Generics No Longer Assignable to <code>{}</code> <a class="header-anchor" href="#unconstrained-generics-no-longer-assignable-to" aria-label="Permalink to &quot;Unconstrained Generics No Longer Assignable to \`{}\`&quot;">​</a></h3><p>In TypeScript 4.8, for projects with <code>strictNullChecks</code> enabled, TypeScript will now correctly issue an error when an unconstrained type parameter is used in a position where <code>null</code> or <code>undefined</code> are not legal values. That will include any type that expects <code>{}</code>, <code>object</code>, or an object type with all-optional properties.</p><p>A simple example can be seen in the following.</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">// Accepts any non-null non-undefined value</span></span>
<span class="line"><span style="color:#F286C4;">function</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">bar</span><span style="color:#F6F6F4;">(</span><span style="color:#FFB86C;font-style:italic;">value</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> {}) {</span></span>
<span class="line"><span style="color:#F6F6F4;">  Object.</span><span style="color:#62E884;">keys</span><span style="color:#F6F6F4;">(value); </span><span style="color:#7B7F8B;">// This call throws on null/undefined at runtime.</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7B7F8B;">// Unconstrained type parameter T...</span></span>
<span class="line"><span style="color:#F286C4;">function</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">foo</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#FFB86C;font-style:italic;">T</span><span style="color:#F6F6F4;">&gt;(</span><span style="color:#FFB86C;font-style:italic;">x</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">T</span><span style="color:#F6F6F4;">) {</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#62E884;">bar</span><span style="color:#F6F6F4;">(x); </span><span style="color:#7B7F8B;">// Used to be allowed, now is an error in 4.8.</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">//  ~</span></span>
<span class="line"><span style="color:#F6F6F4;">    </span><span style="color:#7B7F8B;">// error: Argument of type &#39;T&#39; is not assignable to parameter of type &#39;{}&#39;.</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#62E884;">foo</span><span style="color:#F6F6F4;">(</span><span style="color:#BF9EEE;">undefined</span><span style="color:#F6F6F4;">);</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// Accepts any non-null non-undefined value</span></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">bar</span><span style="color:#24292E;">(</span><span style="color:#E36209;">value</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> {}) {</span></span>
<span class="line"><span style="color:#24292E;">  Object.</span><span style="color:#6F42C1;">keys</span><span style="color:#24292E;">(value); </span><span style="color:#6A737D;">// This call throws on null/undefined at runtime.</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Unconstrained type parameter T...</span></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">foo</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">&gt;(</span><span style="color:#E36209;">x</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">bar</span><span style="color:#24292E;">(x); </span><span style="color:#6A737D;">// Used to be allowed, now is an error in 4.8.</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">//  ~</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">// error: Argument of type &#39;T&#39; is not assignable to parameter of type &#39;{}&#39;.</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">foo</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">undefined</span><span style="color:#24292E;">);</span></span></code></pre></div><p>As demonstrated above, code like this has a potential bug - the values <code>null</code> and <code>undefined</code> can be indirectly passed through these unconstrained type parameters to code that is not supposed to observe those values.</p><p>This behavior will also be visible in type positions. One example would be:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">interface</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Foo</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#FFB86C;font-style:italic;">T</span><span style="color:#F6F6F4;">&gt; {</span></span>
<span class="line"><span style="color:#F6F6F4;">  x</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Bar</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#FFB86C;font-style:italic;">T</span><span style="color:#F6F6F4;">&gt;;</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F286C4;">interface</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Bar</span><span style="color:#F6F6F4;">&lt;</span><span style="color:#FFB86C;font-style:italic;">T</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">extends</span><span style="color:#F6F6F4;"> {}&gt; { }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Foo</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">&gt; {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">x</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Bar</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;">&gt;;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">interface</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Bar</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">T</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">extends</span><span style="color:#24292E;"> {}&gt; { }</span></span></code></pre></div><p>Existing code that didn&#39;t want to handle <code>null</code> and <code>undefined</code> can be fixed by propagating the appropriate constraints through.</p><div class="language-diff"><button title="Copy Code" class="copy"></button><span class="lang">diff</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#EE6666;">- function foo&lt;T&gt;(x: T) {</span></span>
<span class="line"><span style="color:#62E884;">+ function foo&lt;T extends {}&gt;(x: T) {</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#B31D28;">- function foo&lt;T&gt;(x: T) {</span></span>
<span class="line"><span style="color:#22863A;">+ function foo&lt;T extends {}&gt;(x: T) {</span></span></code></pre></div><p>Another work-around would be to check for <code>null</code> and <code>undefined</code> at runtime.</p><div class="language-diff"><button title="Copy Code" class="copy"></button><span class="lang">diff</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">function foo&lt;T&gt;(x: T) {</span></span>
<span class="line"><span style="color:#62E884;">+     if (x !== null &amp;&amp; x !== undefined) {</span></span>
<span class="line"><span style="color:#F6F6F4;">          bar(x);</span></span>
<span class="line"><span style="color:#62E884;">+     }</span></span>
<span class="line"><span style="color:#F6F6F4;">  }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">function foo&lt;T&gt;(x: T) {</span></span>
<span class="line"><span style="color:#22863A;">+     if (x !== null &amp;&amp; x !== undefined) {</span></span>
<span class="line"><span style="color:#24292E;">          bar(x);</span></span>
<span class="line"><span style="color:#22863A;">+     }</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span></code></pre></div><p>And if you know that for some reason, your generic value can&#39;t be <code>null</code> or <code>undefined</code>, you can just use a non-null assertion.</p><div class="language-diff"><button title="Copy Code" class="copy"></button><span class="lang">diff</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">function foo&lt;T&gt;(x: T) {</span></span>
<span class="line"><span style="color:#EE6666;">-     bar(x);</span></span>
<span class="line"><span style="color:#62E884;">+     bar(x!);</span></span>
<span class="line"><span style="color:#F6F6F4;">  }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">function foo&lt;T&gt;(x: T) {</span></span>
<span class="line"><span style="color:#B31D28;">-     bar(x);</span></span>
<span class="line"><span style="color:#22863A;">+     bar(x!);</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span></code></pre></div><p>When it comes to types, you&#39;ll often either need to propagate constraints, or intersect your types with <code>{}</code>.</p><p>For more information, you can <a href="https://github.com/microsoft/TypeScript/pull/49119" target="_blank" rel="noreferrer">see the change that introduced this</a> along with <a href="https://github.com/microsoft/TypeScript/issues/49489" target="_blank" rel="noreferrer">the specific discussion issue regarding how unconstrained generics now work</a>.</p><h3 id="decorators-are-placed-on-modifiers-on-typescript-s-syntax-trees" tabindex="-1">Decorators are placed on <code>modifiers</code> on TypeScript&#39;s Syntax Trees <a class="header-anchor" href="#decorators-are-placed-on-modifiers-on-typescript-s-syntax-trees" aria-label="Permalink to &quot;Decorators are placed on \`modifiers\` on TypeScript&#39;s Syntax Trees&quot;">​</a></h3><p>The current direction of decorators in TC39 means that TypeScript will have to handle a break in terms of placement of decorators. Previously, TypeScript assumed decorators would always be placed prior to all keywords/modifiers. For example</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">@</span><span style="color:#62E884;font-style:italic;">decorator</span></span>
<span class="line"><span style="color:#F286C4;">export</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">Foo</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// ...</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">@decorator</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Foo</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// ...</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>Decorators as currently proposed do not support this syntax. Instead, the <code>export</code> keyword must precede the decorator.</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">export</span><span style="color:#F6F6F4;"> @</span><span style="color:#62E884;font-style:italic;">decorator</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">class</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;">Foo</span><span style="color:#F6F6F4;"> {</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span><span style="color:#7B7F8B;">// ...</span></span>
<span class="line"><span style="color:#F6F6F4;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> @decorator </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Foo</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">// ...</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>Unfortunately, TypeScript&#39;s trees are <em>concrete</em> rather than <em>abstract</em>, and our architecture expects syntax tree node fields to be entirely ordered before or after each other. To support both legacy decorators and decorators as proposed, TypeScript will have to gracefully parse, and intersperse, modifiers and decorators.</p><p>To do this, it exposes a new type alias called <code>ModifierLike</code> which is a <code>Modifier</code> or a <code>Decorator</code>.</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">export</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">type</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">ModifierLike</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Modifier</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">|</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Decorator</span><span style="color:#F6F6F4;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">type</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ModifierLike</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Modifier</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Decorator</span><span style="color:#24292E;">;</span></span></code></pre></div><p>Decorators are now placed in the same field as <code>modifiers</code> which is now a <code>NodeArray&lt;ModifierLike&gt;</code> when set, and the entire field is deprecated.</p><div class="language-diff"><button title="Copy Code" class="copy"></button><span class="lang">diff</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#EE6666;">- readonly modifiers?: NodeArray&lt;Modifier&gt; | undefined;</span></span>
<span class="line"><span style="color:#62E884;">+ /**</span></span>
<span class="line"><span style="color:#62E884;">+  * @deprecated ...</span></span>
<span class="line"><span style="color:#62E884;">+  * Use \`ts.canHaveModifiers()\` to test whether a \`Node\` can have modifiers.</span></span>
<span class="line"><span style="color:#62E884;">+  * Use \`ts.getModifiers()\` to get the modifiers of a \`Node\`.</span></span>
<span class="line"><span style="color:#62E884;">+  * ...</span></span>
<span class="line"><span style="color:#62E884;">+  */</span></span>
<span class="line"><span style="color:#62E884;">+ readonly modifiers?: NodeArray&lt;ModifierLike&gt; | undefined;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#B31D28;">- readonly modifiers?: NodeArray&lt;Modifier&gt; | undefined;</span></span>
<span class="line"><span style="color:#22863A;">+ /**</span></span>
<span class="line"><span style="color:#22863A;">+  * @deprecated ...</span></span>
<span class="line"><span style="color:#22863A;">+  * Use \`ts.canHaveModifiers()\` to test whether a \`Node\` can have modifiers.</span></span>
<span class="line"><span style="color:#22863A;">+  * Use \`ts.getModifiers()\` to get the modifiers of a \`Node\`.</span></span>
<span class="line"><span style="color:#22863A;">+  * ...</span></span>
<span class="line"><span style="color:#22863A;">+  */</span></span>
<span class="line"><span style="color:#22863A;">+ readonly modifiers?: NodeArray&lt;ModifierLike&gt; | undefined;</span></span></code></pre></div><p>All existing <code>decorators</code> properties have been marked as deprecated and will always be <code>undefined</code> if read. The type has also been changed to <code>undefined</code> so that existing tools know to handle them correctly.</p><div class="language-diff"><button title="Copy Code" class="copy"></button><span class="lang">diff</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#EE6666;">- readonly decorators?: NodeArray&lt;Decorator&gt; | undefined;</span></span>
<span class="line"><span style="color:#62E884;">+ /**</span></span>
<span class="line"><span style="color:#62E884;">+  * @deprecated ...</span></span>
<span class="line"><span style="color:#62E884;">+  * Use \`ts.canHaveDecorators()\` to test whether a \`Node\` can have decorators.</span></span>
<span class="line"><span style="color:#62E884;">+  * Use \`ts.getDecorators()\` to get the decorators of a \`Node\`.</span></span>
<span class="line"><span style="color:#62E884;">+  * ...</span></span>
<span class="line"><span style="color:#62E884;">+  */</span></span>
<span class="line"><span style="color:#62E884;">+ readonly decorators?: undefined;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#B31D28;">- readonly decorators?: NodeArray&lt;Decorator&gt; | undefined;</span></span>
<span class="line"><span style="color:#22863A;">+ /**</span></span>
<span class="line"><span style="color:#22863A;">+  * @deprecated ...</span></span>
<span class="line"><span style="color:#22863A;">+  * Use \`ts.canHaveDecorators()\` to test whether a \`Node\` can have decorators.</span></span>
<span class="line"><span style="color:#22863A;">+  * Use \`ts.getDecorators()\` to get the decorators of a \`Node\`.</span></span>
<span class="line"><span style="color:#22863A;">+  * ...</span></span>
<span class="line"><span style="color:#22863A;">+  */</span></span>
<span class="line"><span style="color:#22863A;">+ readonly decorators?: undefined;</span></span></code></pre></div><p>To avoid new deprecation warnings and other issues, TypeScript now exposes four new functions to use in place of the <code>decorators</code> and <code>modifiers</code> properties. There are individual predicates for testing whether a node has support modifiers and decorators, along with respective accessor functions for grabbing them.</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">function</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">canHaveModifiers</span><span style="color:#F6F6F4;">(</span><span style="color:#FFB86C;font-style:italic;">node</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Node</span><span style="color:#F6F6F4;">)</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">node</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">is</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">HasModifiers</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F286C4;">function</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">getModifiers</span><span style="color:#F6F6F4;">(</span><span style="color:#FFB86C;font-style:italic;">node</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">HasModifiers</span><span style="color:#F6F6F4;">)</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">readonly</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Modifier</span><span style="color:#F6F6F4;">[] </span><span style="color:#F286C4;">|</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">undefined</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F286C4;">function</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">canHaveDecorators</span><span style="color:#F6F6F4;">(</span><span style="color:#FFB86C;font-style:italic;">node</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Node</span><span style="color:#F6F6F4;">)</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#FFB86C;font-style:italic;">node</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">is</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">HasDecorators</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"><span style="color:#F286C4;">function</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">getDecorators</span><span style="color:#F6F6F4;">(</span><span style="color:#FFB86C;font-style:italic;">node</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">HasDecorators</span><span style="color:#F6F6F4;">)</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">readonly</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Decorator</span><span style="color:#F6F6F4;">[] </span><span style="color:#F286C4;">|</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">undefined</span><span style="color:#F6F6F4;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">canHaveModifiers</span><span style="color:#24292E;">(</span><span style="color:#E36209;">node</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Node</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#E36209;">node</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">is</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">HasModifiers</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">getModifiers</span><span style="color:#24292E;">(</span><span style="color:#E36209;">node</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">HasModifiers</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">readonly</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Modifier</span><span style="color:#24292E;">[] </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">undefined</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">canHaveDecorators</span><span style="color:#24292E;">(</span><span style="color:#E36209;">node</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Node</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#E36209;">node</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">is</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">HasDecorators</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">getDecorators</span><span style="color:#24292E;">(</span><span style="color:#E36209;">node</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">HasDecorators</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">readonly</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Decorator</span><span style="color:#24292E;">[] </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">undefined</span><span style="color:#24292E;">;</span></span></code></pre></div><p>As an example of how to access modifiers off of a node, you can write</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> modifiers </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">canHaveModifiers</span><span style="color:#F6F6F4;">(myNode) </span><span style="color:#F286C4;">?</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">getModifiers</span><span style="color:#F6F6F4;">(myNode) </span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#BF9EEE;">undefined</span><span style="color:#F6F6F4;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">modifiers</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">canHaveModifiers</span><span style="color:#24292E;">(myNode) </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">getModifiers</span><span style="color:#24292E;">(myNode) </span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">undefined</span><span style="color:#24292E;">;</span></span></code></pre></div><p>With the note that each call to <code>getModifiers</code> and <code>getDecorators</code> may allocate a new array.</p><p>For more information, see changes around</p><ul><li><a href="https://github.com/microsoft/TypeScript/pull/49089" target="_blank" rel="noreferrer">the restructuring of our tree nodes</a></li><li><a href="https://github.com/microsoft/TypeScript/pull/50343" target="_blank" rel="noreferrer">the deprecations</a></li><li><a href="https://github.com/microsoft/TypeScript/pull/50399" target="_blank" rel="noreferrer">exposing the predicate functions</a></li></ul><h3 id="types-cannot-be-imported-exported-in-javascript-files" tabindex="-1">Types Cannot Be Imported/Exported in JavaScript Files <a class="header-anchor" href="#types-cannot-be-imported-exported-in-javascript-files" aria-label="Permalink to &quot;Types Cannot Be Imported/Exported in JavaScript Files&quot;">​</a></h3><p>TypeScript previously allowed JavaScript files to import and export entities declared with a type, but no value, in <code>import</code> and <code>export</code> statements. This behavior was incorrect, because named imports and exports for values that don&#39;t exist will cause a runtime error under ECMAScript modules. When a JavaScript file is type-checked under <code>--checkJs</code> or through a <code>// @ts-check</code> comment, TypeScript will now issue an error.</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#7B7F8B;">// @ts-check</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7B7F8B;">// Will fail at runtime because &#39;SomeType&#39; is not a value.</span></span>
<span class="line"><span style="color:#F286C4;">import</span><span style="color:#F6F6F4;"> { someValue, SomeType } </span><span style="color:#F286C4;">from</span><span style="color:#F6F6F4;"> </span><span style="color:#DEE492;">&quot;</span><span style="color:#E7EE98;">some-module</span><span style="color:#DEE492;">&quot;</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7B7F8B;">/**</span></span>
<span class="line"><span style="color:#7B7F8B;"> * </span><span style="color:#F286C4;">@type</span><span style="color:#7B7F8B;"> </span><span style="color:#97E1F1;font-style:italic;">{SomeType}</span></span>
<span class="line"><span style="color:#7B7F8B;"> */</span></span>
<span class="line"><span style="color:#F286C4;">export</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">const</span><span style="color:#F6F6F4;"> myValue </span><span style="color:#F286C4;">=</span><span style="color:#F6F6F4;"> someValue;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7B7F8B;">/**</span></span>
<span class="line"><span style="color:#7B7F8B;"> * </span><span style="color:#F286C4;">@typedef</span><span style="color:#7B7F8B;"> </span><span style="color:#97E1F1;font-style:italic;">{string | number}</span><span style="color:#7B7F8B;"> </span><span style="color:#97E1F1;font-style:italic;">MyType</span></span>
<span class="line"><span style="color:#7B7F8B;"> */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7B7F8B;">// Will fail at runtime because &#39;MyType&#39; is not a value.</span></span>
<span class="line"><span style="color:#F286C4;">export</span><span style="color:#F6F6F4;"> { MyType </span><span style="color:#F286C4;">as</span><span style="color:#F6F6F4;"> MyExportedType };</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">// @ts-check</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Will fail at runtime because &#39;SomeType&#39; is not a value.</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> { someValue, SomeType } </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;some-module&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;"> * </span><span style="color:#D73A49;">@type</span><span style="color:#6A737D;"> </span><span style="color:#6F42C1;">{SomeType}</span></span>
<span class="line"><span style="color:#6A737D;"> */</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">const</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">myValue</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> someValue;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">/**</span></span>
<span class="line"><span style="color:#6A737D;"> * </span><span style="color:#D73A49;">@typedef</span><span style="color:#6A737D;"> </span><span style="color:#6F42C1;">{string | number}</span><span style="color:#6A737D;"> </span><span style="color:#6F42C1;">MyType</span></span>
<span class="line"><span style="color:#6A737D;"> */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Will fail at runtime because &#39;MyType&#39; is not a value.</span></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> { MyType </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> MyExportedType };</span></span></code></pre></div><p>To reference a type from another module, you can instead directly qualify the import.</p><div class="language-diff"><button title="Copy Code" class="copy"></button><span class="lang">diff</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#EE6666;">- import { someValue, SomeType } from &quot;some-module&quot;;</span></span>
<span class="line"><span style="color:#62E884;">+ import { someValue } from &quot;some-module&quot;;</span></span>
<span class="line"><span style="color:#F6F6F4;">  </span></span>
<span class="line"><span style="color:#F6F6F4;">  /**</span></span>
<span class="line"><span style="color:#EE6666;">-  * @type {SomeType}</span></span>
<span class="line"><span style="color:#62E884;">+  * @type {import(&quot;some-module&quot;).SomeType}</span></span>
<span class="line"><span style="color:#F6F6F4;">   */</span></span>
<span class="line"><span style="color:#F6F6F4;">  export const myValue = someValue;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#B31D28;">- import { someValue, SomeType } from &quot;some-module&quot;;</span></span>
<span class="line"><span style="color:#22863A;">+ import { someValue } from &quot;some-module&quot;;</span></span>
<span class="line"><span style="color:#24292E;">  </span></span>
<span class="line"><span style="color:#24292E;">  /**</span></span>
<span class="line"><span style="color:#B31D28;">-  * @type {SomeType}</span></span>
<span class="line"><span style="color:#22863A;">+  * @type {import(&quot;some-module&quot;).SomeType}</span></span>
<span class="line"><span style="color:#24292E;">   */</span></span>
<span class="line"><span style="color:#24292E;">  export const myValue = someValue;</span></span></code></pre></div><p>To export a type, you can just use a <code>/** @typedef */</code> comment in JSDoc. <code>@typedef</code> comments already automatically export types from their containing modules.</p><div class="language-diff"><button title="Copy Code" class="copy"></button><span class="lang">diff</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F6F6F4;">/**</span></span>
<span class="line"><span style="color:#F6F6F4;">   * @typedef {string | number} MyType</span></span>
<span class="line"><span style="color:#F6F6F4;">   */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#62E884;">+ /**</span></span>
<span class="line"><span style="color:#62E884;">+  * @typedef {MyType} MyExportedType</span></span>
<span class="line"><span style="color:#62E884;">+  */</span></span>
<span class="line"><span style="color:#EE6666;">- export { MyType as MyExportedType };</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">/**</span></span>
<span class="line"><span style="color:#24292E;">   * @typedef {string | number} MyType</span></span>
<span class="line"><span style="color:#24292E;">   */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;">+ /**</span></span>
<span class="line"><span style="color:#22863A;">+  * @typedef {MyType} MyExportedType</span></span>
<span class="line"><span style="color:#22863A;">+  */</span></span>
<span class="line"><span style="color:#B31D28;">- export { MyType as MyExportedType };</span></span></code></pre></div><p>You can <a href="https://github.com/microsoft/TypeScript/pull/49580" target="_blank" rel="noreferrer">read more about the change here</a>.</p><h3 id="binding-patterns-do-not-directly-contribute-to-inference-candidates" tabindex="-1">Binding Patterns Do Not Directly Contribute to Inference Candidates <a class="header-anchor" href="#binding-patterns-do-not-directly-contribute-to-inference-candidates" aria-label="Permalink to &quot;Binding Patterns Do Not Directly Contribute to Inference Candidates&quot;">​</a></h3><p>As mentioned above, binding patterns no longer change the type of inference results in function calls. You can <a href="https://github.com/microsoft/TypeScript/pull/49086" target="_blank" rel="noreferrer">read more about the original change here</a>.</p><h3 id="unused-renames-in-binding-patterns-are-now-errors-in-type-signatures" tabindex="-1">Unused Renames in Binding Patterns are Now Errors in Type Signatures <a class="header-anchor" href="#unused-renames-in-binding-patterns-are-now-errors-in-type-signatures" aria-label="Permalink to &quot;Unused Renames in Binding Patterns are Now Errors in Type Signatures&quot;">​</a></h3><p>TypeScript&#39;s type annotation syntax often looks like it can be used when destructuring values. For example, take the following function.</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">declare</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">function</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">makePerson</span><span style="color:#F6F6F4;">({ name: </span><span style="color:#FFB86C;font-style:italic;">string</span><span style="color:#F6F6F4;">, age: </span><span style="color:#FFB86C;font-style:italic;">number</span><span style="color:#F6F6F4;"> })</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Person</span><span style="color:#F6F6F4;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">declare</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">makePerson</span><span style="color:#24292E;">({ </span><span style="color:#E36209;">name</span><span style="color:#24292E;">: </span><span style="color:#E36209;">string</span><span style="color:#24292E;">, </span><span style="color:#E36209;">age</span><span style="color:#24292E;">: </span><span style="color:#E36209;">number</span><span style="color:#24292E;"> })</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Person</span><span style="color:#24292E;">;</span></span></code></pre></div><p>You might read this signature and think that <code>makePerson</code> obviously takes an object with a <code>name</code> property with the type <code>string</code> and an <code>age</code> property with the type <code>number</code>; however, JavaScript&#39;s destructuring syntax is actually taking precedence here. <code>makePerson</code> does say that it&#39;s going to take an object with a <code>name</code> and an <code>age</code> property, but instead of specifying a type for them, it&#39;s just saying that it renames <code>name</code> and <code>age</code> to <code>string</code> and <code>number</code> respectively.</p><p>In a pure type construct, writing code like this is useless, and typically a mistake since developers usually assume they&#39;re writing a type annotation.</p><p>TypeScript 4.8 makes these an error unless they&#39;re referenced later in the signature. The correct way to write the above signature would be as follows:</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki dracula-soft vp-code-dark"><code><span class="line"><span style="color:#F286C4;">declare</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">function</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">makePerson</span><span style="color:#F6F6F4;">(</span><span style="color:#FFB86C;font-style:italic;">options</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> { name</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">string</span><span style="color:#F6F6F4;">, age</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">number</span><span style="color:#F6F6F4;"> })</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Person</span><span style="color:#F6F6F4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7B7F8B;">// or</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F286C4;">declare</span><span style="color:#F6F6F4;"> </span><span style="color:#F286C4;">function</span><span style="color:#F6F6F4;"> </span><span style="color:#62E884;">makePerson</span><span style="color:#F6F6F4;">({ </span><span style="color:#FFB86C;font-style:italic;">name</span><span style="color:#F6F6F4;">, </span><span style="color:#FFB86C;font-style:italic;">age</span><span style="color:#F6F6F4;"> }</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> { name</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">string</span><span style="color:#F6F6F4;">, age</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">number</span><span style="color:#F6F6F4;"> })</span><span style="color:#F286C4;">:</span><span style="color:#F6F6F4;"> </span><span style="color:#97E1F1;font-style:italic;">Person</span><span style="color:#F6F6F4;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">declare</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">makePerson</span><span style="color:#24292E;">(</span><span style="color:#E36209;">options</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> { </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">string</span><span style="color:#24292E;">, </span><span style="color:#E36209;">age</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">number</span><span style="color:#24292E;"> })</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Person</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// or</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">declare</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">makePerson</span><span style="color:#24292E;">({ </span><span style="color:#E36209;">name</span><span style="color:#24292E;">, </span><span style="color:#E36209;">age</span><span style="color:#24292E;"> }</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> { </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">string</span><span style="color:#24292E;">, </span><span style="color:#E36209;">age</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">number</span><span style="color:#24292E;"> })</span><span style="color:#D73A49;">:</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Person</span><span style="color:#24292E;">;</span></span></code></pre></div><p>This change can catch bugs in declarations, and has been helpful for improving existing code. We&#39;d like to extend our thanks to <a href="https://github.com/uhyo" target="_blank" rel="noreferrer">GitHub user uhyo</a> for providing this check. <a href="https://github.com/microsoft/TypeScript/pull/41044" target="_blank" rel="noreferrer">You can read up on the change here</a>.</p>`,112),p=[l];function t(c,r,i,y,F,d){return n(),a("div",null,p)}const f=s(o,[["render",t]]);export{h as __pageData,f as default};
